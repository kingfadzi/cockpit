# ARB Dashboard Design Specification

## Document Overview

**Version**: 1.2
**Purpose**: Complete design specification for the application-centric ARB Dashboard redesign
**Last Updated**: 2025-10-13
**Status**: Ready for Implementation
**Related Documents**:
- [ARB_DASHBOARD_KEY_QUESTIONS.md](./ARB_DASHBOARD_KEY_QUESTIONS.md)
- [profile-fields.registry.yaml](./profile-fields.registry.yaml) - Policy registry defining auto-generated risks

---

## Table of Contents

1. [Design Philosophy](#design-philosophy)
2. [User Personas & Use Cases](#user-personas--use-cases)
3. [Information Architecture](#information-architecture)
4. [Component Specifications](#component-specifications)
5. [Interaction Model](#interaction-model)
6. [Data Requirements](#data-requirements)
7. [Implementation Roadmap](#implementation-roadmap)
8. [Success Metrics](#success-metrics)

---

## Design Philosophy

### Core Principles

1. **Application-First**: Applications are the unit of governance. All data is organized around applications, not abstract metrics.

2. **Personalized by Default**: Users see THEIR work first (assigned risks, their domain), then can explore beyond their immediate scope.

3. **Progressive Disclosure**: Summary → List → Detail drill-down pattern. Don't overwhelm, but make depth available.

4. **Action-Oriented**: Every insight has a corresponding action. Every click moves the user toward resolution.

5. **Context-Aware**: Different views for different ARB domains (Security, Data, Operations, Enterprise Architecture).

6. **Policy-Driven with Expert Judgment**: The majority of risks (80-90%) are automatically generated by the backend based on the policy registry (`profile-fields.registry.yaml`). ARB experts can also manually create risks (10-20%) when they discover issues during reviews that aren't automatically detectable.

### How The System Works: Policy-Driven Risk Generation

**Primary Source: Auto-Generated Risks**

The majority of risks are automatically generated by the backend when:
1. An application's rating (e.g., `security_rating: A1`) requires a control
2. Evidence for that control is missing OR stale (past TTL)
3. The registry field has `requires_review: true` → risk routes to ARB queue

**Example Flow (Auto-Generated)**:
```
Application: Customer Portal
Rating: security_rating = A1 (highest criticality)
   ↓
Registry Rule: waf_protection for A1 = {required, ttl: 90d, priority: CRITICAL}
   ↓
Evidence Check: WAF config evidence is 95 days old (expired)
   ↓
Backend Auto-Generates: "Stale Evidence: WAF Configuration (95 days, 5 days overdue)"
   ↓
requires_review: true → Risk sent to Security ARB queue
   ↓
Security ARB Expert sees it in "MY QUEUE" and can:
   - Request updated evidence
   - Assign to app owner
   - Accept risk (with justification)
   - Update status to IN_PROGRESS
```

**Secondary Source: Manually Created Risks**

ARB experts **can also create risks manually** when they discover issues that aren't automatically detectable:
- During architecture reviews, discover design concerns not covered by existing policies
- Identify emerging threat patterns across applications
- Document exceptions or special findings that require tracking
- Raise cross-cutting concerns that span multiple policy areas

**Example Flow (Manual Creation)**:
```
Security ARB Expert reviewing Customer Portal
   ↓
During review, discovers: API endpoint lacks rate limiting (not in policy registry)
   ↓
Expert manually creates risk:
   - Title: "Missing Rate Limiting on Public API"
   - Priority: HIGH
   - Assigns to app owner
   - Status: OPEN
   ↓
Risk appears in dashboard, tracked like auto-generated risks
```

**Key Distinction**:
- **Auto-generated risks** = Policy compliance gaps (80-90% of risks)
- **Manually created risks** = Expert judgment, emerging threats, review findings (10-20% of risks)

**ARB Expert Workflows**:
- ✅ Review auto-generated risks in their queue (primary workflow)
- ✅ Manually create risks during reviews when discovering non-policy issues
- ✅ Triage and prioritize based on dashboard insights
- ✅ Assign ownership and track resolution
- ✅ Approve/accept risk exceptions

This dashboard is designed to **surface and triage** both policy violations and expert-identified risks efficiently.

### Key Questions Addressed

The dashboard must answer these 8 foundational questions immediately:

#### Immediate Priorities
1. Which applications pose the highest risk to my domain *right now*?
2. How many critical risks do I need to deal with across the entire application portfolio?
3. What is the total number of open, unresolved items that my team needs to address?

#### Workload and Triage
4. Which applications have the most open risk items?
5. How many new risks have appeared recently (in the last week vs. the last month)?
6. What is the breakdown of risks by status?

#### Performance and Progress
7. How effective have we been at resolving risks recently? Is our resolution rate keeping up with the rate of new risks?
8. What is the overall health score (Average Priority Score) for my domain? Is it getting better or worse?

---

## User Personas & Use Cases

### How Risks Are Generated

**Critical Context**: Risks in this system are **policy-driven and auto-generated**, not manually created. The backend automatically generates risks when:

1. **Requirements aren't met**: Applications have ratings (security_rating, confidentiality_rating, integrity_rating, availability_rating, resilience_rating). Based on these ratings (A/B/C/D or A1/A2/B/C/D or 0/1/2/3/4), specific control requirements apply.

2. **Evidence is stale**: Each control requirement has a TTL (time-to-live). When evidence expires past the TTL, a risk is auto-generated.

3. **Requires review flag**: If the registry field has `requires_review: true` for that rating level, the risk goes directly to the ARB queue for review.

**Example**: An application with `security_rating: A1` must have WAF protection evidence. The requirement has `ttl: 90d` and `requires_review: true`. If evidence isn't provided or is stale (>90 days old), the system auto-generates a "Missing Security Evidence: WAF Configuration" risk and routes it to the Security ARB queue.

### Primary Personas

#### 1. Security ARB Expert
**Goals**:
- Review auto-generated risks for missing or stale security evidence
- Triage compliance gaps identified by the policy engine
- Ensure applications meet security requirements based on their ratings

**Key Workflows** (based on `profile-fields.registry.yaml`):
- Review missing WAF protection evidence (`waf_protection` - ttl: 90d for A1/A2/B)
- Triage encryption compliance gaps (`encryption_at_rest`, `encryption_in_transit`)
- Review stale security testing evidence (`security_testing` - varies by rating)
- Address MFA enforcement violations (`mfa_enforcement`)
- Review expired SBOM requirements (`dependency_management`)
- Triage network segmentation gaps (`network_segmentation`)
- Review stale SIEM integration evidence (`siem_integration`)
- Address secrets management violations (`secrets_management`)
- Review key rotation policy breaches (`key_rotation_max`)

**Typical Risk Titles**:
- "Missing Security Evidence: WAF Configuration"
- "Stale Evidence: Encryption at Rest (90 days expired)"
- "Policy Violation: MFA Not Enforced (A1 rating requires MFA)"
- "Missing SBOM: Dependency Management Evidence Required"

#### 2. Data Governance Expert
**Goals**:
- Review auto-generated risks for data handling policy violations
- Triage confidentiality and integrity compliance gaps
- Ensure applications meet data governance requirements

**Key Workflows** (based on `profile-fields.registry.yaml`):
- Review confidentiality level violations (`confidentiality_level`)
- Triage data residency control gaps (`data_residency_control`)
- Review missing de-identification requirements (`de_identification`)
- Address stale access review evidence (`access_review` - quarterly for A-rated)
- Review data retention policy gaps (`data_retention_policy`)
- Triage audit logging compliance (`audit_logging`)
- Review data validation violations (`data_validation`)
- Address missing reconciliation evidence (`reconciliation_frequency`)
- Review change control gaps (`change_control`)
- Triage log retention policy violations (`log_retention`)
- Review secure data deletion evidence (`data_deletion_evidence`)
- Address TPSP attestation gaps (`tpsp_attestation`)

**Typical Risk Titles**:
- "Policy Violation: Confidential Data Requires Restricted Classification"
- "Stale Evidence: Access Review Overdue (Quarterly required)"
- "Missing Evidence: Data Retention Policy Not Defined"
- "Compliance Gap: Audit Logging Evidence Required"

#### 3. Operations & Resilience Expert
**Goals**:
- Review auto-generated risks for availability and resilience gaps
- Triage RTO/RPO compliance violations
- Ensure applications meet operational requirements

**Key Workflows** (based on `profile-fields.registry.yaml`):
- Review RTO/RPO compliance gaps (`rto_hours`, `rpo_minutes`)
- Triage DR test staleness (`dr_test_frequency` - semi-annual for "0" resilience rating)
- Review missing/stale incident response plans (`ir_plan`, `ir_exercise`)
- Address backup policy violations (`backup_policy`)
- Review monitoring SLO gaps (`monitoring_slos`)
- Triage HA topology requirements (`ha_topology`)
- Review on-call coverage gaps (`oncall_coverage`)
- Address failover automation requirements (`failover_automation`)
- Review runbook maturity violations (`runbook_maturity`)
- Triage chaos testing requirements (`chaos_testing`)

**Typical Risk Titles**:
- "Policy Violation: RTO Target Not Met (≤1 hour required for A-rated)"
- "Stale Evidence: DR Test Overdue (Semi-annual live test required)"
- "Missing Evidence: Incident Response Plan Not Documented"
- "Compliance Gap: Monitoring SLO Below Required 99.9%"

#### 4. Enterprise Architect
**Goals**:
- Review auto-generated risks for governance artifact gaps
- Triage architectural documentation violations
- Ensure applications have required vision and roadmap documents

**Key Workflows** (based on `profile-fields.registry.yaml`):
- Review missing product vision documents (`product_vision`)
- Triage missing product roadmaps (`product_roadmap`)
- Review missing architecture vision (`architecture_vision`)
- Address missing service vision (`service_vision`)
- Review missing security vision (`security_vision`)
- Triage missing test vision (`test_vision`)

**Typical Risk Titles**:
- "Policy Violation: Product Vision Required (A-rated application)"
- "Missing Artifact: Architecture Vision Not Provided"
- "Stale Evidence: Product Roadmap Overdue for Review (90 days expired)"

### Use Case Examples

#### Use Case 1: Morning Triage
**Persona**: Any ARB Expert
**Flow**:
1. Login → Land on "MY QUEUE" tab
2. See HUD: "12 critical risks assigned to me"
3. Click "12 CRITICAL" → Watchlist filters to show apps with critical risks
4. Click top application → View detailed risk list
5. Review and assign/update status

**Expected Outcome**: User knows exactly what needs attention and can act immediately.

#### Use Case 2: Domain Health Check
**Persona**: Security ARB Expert
**Flow**:
1. Switch to "MY DOMAIN" tab
2. See HUD: Health Score "C (68/100) - ELEVATED"
3. Review "Net Change" metric: "-7 BEHIND"
4. Scroll to watchlist, sort by "Total Open Items"
5. Identify high-volume applications
6. Expand "Insights" section to see concentration risks

**Expected Outcome**: User understands domain health, identifies bottlenecks, and can prioritize effort.

#### Use Case 3: Cross-Domain Investigation
**Persona**: Enterprise Architect
**Flow**:
1. Switch to "ALL DOMAINS" tab
2. Search for specific application
3. View application profile to see risks across all domains
4. Identify systemic issues affecting multiple domains

**Expected Outcome**: User can investigate cross-cutting concerns and coordinate across ARBs.

---

## Information Architecture

### Page Structure

```
┌─────────────────────────────────────────────────────────────┐
│ Top Navigation Bar                                          │
├─────────────────────────────────────────────────────────────┤
│ Scoping Tabs (My Queue | My Domain | All Domains)          │
├─────────────────────────────────────────────────────────────┤
│ Heads-Up Display (HUD) - Dynamic Metrics Bar               │
├─────────────────────────────────────────────────────────────┤
│ Application Watchlist                                       │
│   - Search & Filter Controls                                │
│   - Sortable Table                                          │
│   - Pagination                                              │
├─────────────────────────────────────────────────────────────┤
│ Key Insights & Performance (Collapsible)                    │
│   - Resolution Performance                                  │
│   - Cross-Metric Intelligence                               │
│   - Domain-Specific Insights                                │
└─────────────────────────────────────────────────────────────┘
```

### Navigation Hierarchy

```
ARB Dashboard
├── My Queue (Default)
│   ├── HUD (filtered to assigned risks)
│   └── Watchlist (apps with assigned risks)
│       └── Application Profile Page
│           └── Risk Detail View
├── My Domain
│   ├── HUD (filtered to domain)
│   └── Watchlist (all apps in domain)
│       └── Application Profile Page
│           └── Risk Detail View
└── All Domains
    ├── HUD (global metrics)
    └── Watchlist (all applications)
        └── Application Profile Page
            └── Risk Detail View
```

---

## Component Specifications

### 1. Scoping Tabs

#### Purpose
Define the scope of applications and data shown throughout the dashboard.

#### Visual Design

```
┌────────────────────────────────────────────────────────┐
│ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐      │
│ │ 🎯 MY QUEUE │ │ 🛡️ MY DOMAIN│ │ 🌐 ALL      │      │
│ │   ACTIVE    │ │             │ │   DOMAINS   │      │
│ └─────────────┘ └─────────────┘ └─────────────┘      │
└────────────────────────────────────────────────────────┘
```

#### Tab Specifications

##### 🎯 MY QUEUE (Default Landing)
- **Scope**: Applications with risks assigned to current user
- **Purpose**: "What do I need to work on TODAY?"
- **Filter Logic**:
  ```javascript
  applications.filter(app =>
    app.risks.some(risk =>
      risk.assignedTo === currentUser.id &&
      risk.status !== 'RESOLVED'
    )
  )
  ```
- **HUD Behavior**: Shows metrics for only assigned items
- **Badge**: Shows count of applications with assigned risks

##### 🛡️ MY DOMAIN
- **Scope**: All applications with risks in user's ARB domain
- **Purpose**: "What's the health of my domain's portfolio?"
- **Filter Logic**:
  ```javascript
  applications.filter(app =>
    app.risks.some(risk =>
      risk.arbDomain === currentUser.arbDomain
    )
  )
  ```
- **HUD Behavior**: Shows metrics across entire domain
- **Domain Label**: Dynamically shows domain name (e.g., "🛡️ SECURITY DOMAIN")

##### 🌐 ALL DOMAINS
- **Scope**: Cross-domain view of entire application portfolio
- **Purpose**: "Explore beyond my domain, see systemic issues"
- **Filter Logic**:
  ```javascript
  applications // No filtering
  ```
- **HUD Behavior**: Shows global metrics across all ARBs
- **Multi-Domain Indicators**: Shows when apps have risks in multiple domains

#### Interaction Behavior
- **Default State**: MY QUEUE
- **Persistence**: Tab selection persisted in session storage
- **URL Routing**: `/arb-dashboard?scope=my-queue|my-domain|all-domains`
- **State Management**: Changing tabs triggers data refetch and HUD recalculation

---

### 2. Heads-Up Display (HUD)

#### Purpose
Provide at-a-glance triage metrics that answer foundational questions. All metrics are clickable and filter the watchlist.

#### Visual Design

```
┌────────────────────────────────────────────────────────────┐
│ 🔴 CRITICAL   📋 OPEN      ⏳ PENDING    💚 HEALTH    📊 NET│
│    RISKS       ITEMS        REVIEW       SCORE        CHANGE│
│                                                             │
│    ┌───┐      ┌───┐       ┌───┐        ┌───┐       ┌────┐│
│    │ 12│      │ 47│       │ 23│        │ C │       │ -7 ││
│    └───┘      └───┘       └───┘        └───┘       └────┘│
│    Click →    Click →     Click →      🟠 68/100    (7d) │
│    filter     filter      filter       ELEVATED     🔴    │
└────────────────────────────────────────────────────────────┘
```

#### Metric Specifications

##### 🔴 CRITICAL RISKS

**Data Source**:
```javascript
const criticalCount = applications
  .flatMap(app => app.risks)
  .filter(risk =>
    risk.priority === 'CRITICAL' &&
    risk.status !== 'RESOLVED'
  )
  .length;
```

**Visual Styling**:
- Red if `count > 10`
- Orange if `5 <= count <= 10`
- Green if `count < 5`

**Click Action**:
```javascript
filterWatchlist({
  riskPriority: 'CRITICAL',
  riskStatus: ['OPEN', 'IN_PROGRESS']
});
```

**Tooltip**: "Total critical priority risks in current scope (click to filter)"

---

##### 📋 OPEN ITEMS

**Data Source**:
```javascript
const openItemsCount = applications
  .flatMap(app => app.risks)
  .filter(risk =>
    risk.status === 'OPEN' || risk.status === 'IN_PROGRESS'
  )
  .length;

const totalRisks = applications
  .flatMap(app => app.risks)
  .length;

const percentage = (openItemsCount / totalRisks * 100).toFixed(0);
```

**Display Format**: "47 (52%)"

**Visual Styling**:
- Shows percentage of total risks that are open
- Warning indicator if percentage > 60%

**Click Action**:
```javascript
filterWatchlist({
  riskStatus: ['OPEN', 'IN_PROGRESS']
});
```

**Tooltip**: "All unresolved risks (OPEN + IN_PROGRESS)"

---

##### ⏳ PENDING REVIEW

**Data Source**:
```javascript
const pendingReviewCount = applications
  .flatMap(app => app.risks)
  .filter(risk =>
    risk.status === 'PENDING_REVIEW' || risk.status === 'NEW'
  )
  .length;
```

**Visual Styling**:
- Pulses/animates if `count > 20`
- Red if `count > 30`
- Orange if `15 <= count <= 30`
- Green if `count < 15`

**Click Action**:
```javascript
filterWatchlist({
  riskStatus: ['PENDING_REVIEW', 'NEW']
});
```

**Tooltip**: "Risks awaiting initial ARB review (your triage inbox)"

**Special Behavior**: This is the "review queue" - critical for triage workflow

---

##### 💚 HEALTH SCORE

**Data Source**:
```javascript
const totalScore = applications.reduce((sum, app) =>
  sum + app.aggregatedRiskScore, 0
);
const avgScore = totalScore / applications.length;

function getGrade(score) {
  if (score >= 90) return 'A';
  if (score >= 75) return 'B';
  if (score >= 60) return 'C';
  if (score >= 40) return 'D';
  return 'F';
}

function getStatus(score) {
  if (score >= 75) return 'EXCELLENT';
  if (score >= 60) return 'ELEVATED';
  if (score >= 40) return 'POOR';
  return 'CRITICAL';
}
```

**Display Format**:
```
┌─────────────────┐
│   HEALTH: C     │
│   ━━━━●━━━━━━   │
│   A  B  C  D  F │
│                 │
│   68/100        │
│   🟠 ELEVATED   │
└─────────────────┘
```

**Visual Styling**:
- Letter grade with position indicator on scale
- Color-coded:
  - 🟢 Green: A, B (< 75)
  - 🟠 Orange: C (60-74)
  - 🔴 Red: D, F (< 60)

**Click Action**:
Opens modal/popover showing:
- Grade distribution across applications
- Comparison to other domains (if in MY DOMAIN view)
- Historical context (if available)

**Tooltip**: "Average risk score across applications in scope"

---

##### 📊 NET CHANGE

**Data Source**:
```javascript
const newRisks7d = recentActivity.newRisksLast7Days;
const resolved7d = recentActivity.resolvedLast7Days;
const netChange = resolved7d - newRisks7d;

const resolutionRate = newRisks7d > 0
  ? (resolved7d / newRisks7d * 100).toFixed(0)
  : 100;

function getStatus(resolutionRate) {
  if (resolutionRate >= 100) return 'KEEPING_UP';
  if (resolutionRate >= 70) return 'SLIGHTLY_BEHIND';
  return 'BEHIND';
}
```

**Display Format**:
```
┌─────────────┐
│   -7 NET    │
│   (7 days)  │
│             │
│ 🔴 BEHIND   │
│             │
│ 15 new      │
│ 8 resolved  │
└─────────────┘
```

**Visual Styling**:
- ✅ Green: `resolutionRate >= 100` (keeping up)
- 🟡 Yellow: `70 <= resolutionRate < 100` (slightly behind)
- 🔴 Red: `resolutionRate < 70` (behind)

**Click Action**:
Expands to show detailed resolution performance:
- 30-day comparison
- Burn rate calculation
- Recommendation for weekly resolution target

**Tooltip**: "Net change in open risks (resolved - new) in last 7 days"

---

### 3. Application Watchlist

#### Purpose
Interactive, sortable list of applications that serves as the primary interface for triage and prioritization.

#### Controls Bar

```
┌────────────────────────────────────────────────────────────┐
│ 🔍 Search applications...                  [Export CSV ↓] │
│                                                             │
│ Sort by: [Risk Score ▼] [Open Items] [Critical Count]     │
│ Filter:  [All Statuses ▼] [All Priorities ▼] [All BUs ▼]  │
│                                                             │
│ Showing 15 applications                         [1][2][3]  │
└────────────────────────────────────────────────────────────┘
```

**Search**:
- Real-time search on application name
- Debounced (300ms) for performance
- Case-insensitive
- Highlights matching text

**Sort Options**:
- Risk Score (default) - descending
- Open Items - descending
- Critical Count - descending
- Application Name - ascending

**Filter Options**:
- Status: All, OPEN, IN_PROGRESS, PENDING_REVIEW, RESOLVED
- Priority: All, CRITICAL, HIGH, MEDIUM, LOW
- Business Unit: All, [dynamic list from data]
- Assignment: All, Assigned to Me, Unassigned
- Source: All Risks, Policy-Driven Only, Expert Findings Only

**Pagination**:
- 15 items per page (configurable)
- Standard pagination controls
- "Load More" option as alternative

---

#### Table Layout

```
┌──────────────────────────────────────────────────────────────────────┐
│ #  │ APPLICATION       │ RISK BREAKDOWN   │ TOTAL │ SCORE │ OWNER  │
│    │                   │ Cr│Hi│Med│Lo     │ OPEN  │ (A-F) │        │
├────┼───────────────────┼───┼──┼───┼───────┼───────┼───────┼────────┤
│ 🔥 │ Customer Portal   │🔴3│🟠4│🟡1│ 0    │   8   │ F 87  │J.Smith │
│    │ Security | Data   │   │  │   │       │       │ 🔴    │(You)   │
│    │ 👤 Assigned to you│   │  │   │       │       │       │        │
├────┼───────────────────┼───┼──┼───┼───────┼───────┼───────┼────────┤
│ 🔥 │ Payment Gateway   │🔴1│🟠7│🟡4│ 0    │  12   │ D 72  │M.Lee   │
│    │ Security | Ops    │   │  │   │       │       │ 🟠    │        │
│    │ 📊 High volume    │   │  │   │       │       │       │        │
└────┴───────────────────┴───┴──┴───┴───────┴───────┴───────┴────────┘
```

#### Column Specifications

##### Column 1: Position Indicator (#)
**Width**: 40px
**Content**:
- 🔥 for top 3 applications (rank 1-3)
- ⚠️ for top 4-10 applications
- Empty for others

**Purpose**: Visual urgency signal for highest-priority items

---

##### Column 2: Application
**Width**: 300px (flexible)
**Content** (multi-line):

Line 1: **Application Name** (bold, clickable)
- Font: 16px, bold
- Truncate with ellipsis if > 40 characters
- Show full name on hover

Line 2: **Domain Tags**
- Format: "Security | Data | Operations"
- Shows all ARB domains with risks for this app
- Color-coded chips
- Current user's domain is highlighted

Line 3: **Context Badges** (conditional)
- 👤 "Assigned to you" - appears if user has assigned risks
- 📊 "High volume" - appears if open items > 75th percentile
- 🔔 "X new (7d)" - appears if new risks added in last 7 days
- ⚠️ "Unassigned" - appears if owner is null
- 🕐 "Stale evidence" - appears if any risk has `riskType: 'STALE_EVIDENCE'`
- 🔥 "Missing evidence" - appears if any risk has `riskType: 'MISSING_EVIDENCE'`
- ⚖️ "Policy violation" - appears if any risk has `riskType: 'POLICY_VIOLATION'`

**Interaction**:
- Entire cell is clickable
- Hover state: subtle background color change
- Click: Navigate to Application Profile Page

---

##### Column 3: Risk Breakdown
**Width**: 160px
**Content**: Visual count of risks by priority

```
🔴 3  🟠 4  🟡 1  0
Cr   Hi   Med   Lo
```

**Data Source**:
```javascript
const breakdown = {
  critical: app.risks.filter(r =>
    r.priority === 'CRITICAL' &&
    r.status !== 'RESOLVED'
  ).length,
  high: app.risks.filter(r =>
    r.priority === 'HIGH' &&
    r.status !== 'RESOLVED'
  ).length,
  medium: app.risks.filter(r =>
    r.priority === 'MEDIUM' &&
    r.status !== 'RESOLVED'
  ).length,
  low: app.risks.filter(r =>
    r.priority === 'LOW' &&
    r.status !== 'RESOLVED'
  ).length,
};
```

**Visual Styling**:
- Icons with counts
- Color-coded: 🔴 Critical, 🟠 High, 🟡 Medium, ⚪ Low
- Bold if count > 0
- Grayed out if count = 0

**Sortable**: Click column header to sort by critical count, then high, then medium

**Purpose**: Instant severity distribution visibility for triage

---

##### Column 4: Total Open
**Width**: 80px
**Content**: Sum of all unresolved risks

**Data Source**:
```javascript
const totalOpen = app.risks.filter(r =>
  r.status !== 'RESOLVED'
).length;
```

**Visual Styling**:
- Large number (18px)
- Color-coded:
  - Red if > 15
  - Orange if 10-15
  - Default if < 10

**Sortable**: Yes (descending)

**Purpose**: Answers "Which apps have the most work?"

---

##### Column 5: Score (A-F)
**Width**: 80px
**Content**: Letter grade + numeric score

**Display Format**:
```
  F
 87
```

**Data Source**:
```javascript
const score = app.aggregatedRiskScore; // 0-100
const grade = getGrade(score);
```

**Visual Styling**:
- Letter grade: Large (20px)
- Numeric score: Below, smaller (14px)
- Background color:
  - 🔴 Red: F (< 40)
  - 🟠 Orange: D (40-59), C (60-74)
  - 🟡 Yellow: B (75-89)
  - 🟢 Green: A (90-100)
- Color intensity based on score

**Sortable**: Yes (descending by numeric score)

**Tooltip**: Hover to see detailed score calculation

---

##### Column 6: Owner
**Width**: 120px
**Content**: Application owner name

**Display Format**:
- Name: "J. Smith" (abbreviated)
- "(You)" if owner is current user
- "Unassigned" with ⚠️ if no owner

**Visual Styling**:
- Regular text
- Bold if "(You)"
- Warning color if unassigned

**Clickable**: Click to filter watchlist to all apps owned by this person

---

##### Column 7: BU (Business Unit)
**Width**: 80px
**Content**: Business unit abbreviation

**Examples**:
- "Retail"
- "Platform"
- "Data"
- "Mobile"

**Visual Styling**:
- Small chip/badge
- Different color per BU

**Filterable**: Click to filter by business unit

---

#### Row Interaction Behavior

**Hover State**:
- Subtle background color change (#f5f5f5)
- Cursor changes to pointer
- Slight elevation (box-shadow)

**Click Action**:
- Navigate to Application Profile Page
- Pass application ID and current scope context
- Maintain filter/sort state for "Back" navigation

**Keyboard Navigation**:
- Tab: Focus next row
- Enter: Open application detail
- Arrow keys: Navigate rows

---

### 4. Key Insights & Performance Section

#### Purpose
Provide deeper analytical insights synthesized from current data. Collapsible to keep focus on action-oriented HUD + Watchlist.

#### Visual Design

```
┌────────────────────────────────────────────────────────────┐
│ [▼] INSIGHTS & PERFORMANCE ANALYTICS                       │
├────────────────────────────────────────────────────────────┤
│                                                             │
│ 📊 RESOLUTION PERFORMANCE                                  │
│ 💡 KEY INSIGHTS                                            │
│ 🛡️ DOMAIN-SPECIFIC INSIGHTS                                │
│                                                             │
└────────────────────────────────────────────────────────────┘
```

#### Default State
- Collapsed on first load
- State persisted in localStorage
- Toggle button at top

#### Subsections

##### 📊 Resolution Performance

**Purpose**: Answer Q7 - "How effective have we been at resolving risks?"

**Layout**:
```
┌──────────────────┐  ┌──────────────────┐  ┌──────────────┐
│  15 NEW (7d)     │  │  8 RESOLVED (7d) │  │  BURN RATE   │
│  43 NEW (30d)    │  │ 28 RESOLVED (30d)│  │  12 weeks    │
│                  │  │                  │  │  to clear    │
│  Resolution Rate │  │  Net Change:     │  │              │
│      53%         │  │     -15          │  │  Need: 10/wk │
│   🔴 BEHIND      │  │   🔴 BEHIND      │  │  to clear in │
└──────────────────┘  └──────────────────┘  │  30 days     │
                                            └──────────────┘
```

**Calculations**:
```javascript
// Resolution Rate
const resolutionRate7d = (resolved7d / new7d * 100).toFixed(0);
const resolutionRate30d = (resolved30d / new30d * 100).toFixed(0);

// Burn Rate (weeks to clear current backlog)
const weeklyAvgResolution = resolved30d / 4.3; // 30 days ≈ 4.3 weeks
const burnRateWeeks = openItemsCount / weeklyAvgResolution;

// Target Weekly Resolution (to clear in 30 days)
const targetWeekly = Math.ceil(openItemsCount / 4.3);
```

**Visual Indicators**:
- ✅ Green: Resolution rate >= 100%
- 🟡 Yellow: Resolution rate 70-99%
- 🔴 Red: Resolution rate < 70%

---

##### 💡 Key Insights (Cross-Metric Intelligence)

**Purpose**: Synthesize patterns from current snapshot data

**Insight Types**:

1. **Concentration Risk**
```javascript
// Identify top 3 apps contributing disproportionate critical risks
const totalCritical = /* sum of all critical risks */;
const top3Apps = applications
  .sort((a, b) => b.criticalCount - a.criticalCount)
  .slice(0, 3);
const top3Percentage = (top3Apps.reduce((sum, app) =>
  sum + app.criticalCount, 0) / totalCritical * 100
).toFixed(0);

if (top3Percentage > 40) {
  insights.push({
    icon: '🎯',
    text: `${top3Apps.length} applications (${top3Apps.map(a => a.name).join(', ')}) account for ${top3Percentage}% of all critical risks`,
    recommendation: 'Concentration risk - focus effort here',
    priority: 'high'
  });
}
```

2. **High Volume Applications**
```javascript
// Identify apps with most open items
const avgOpenItems = totalOpen / applications.length;
const highVolumeApps = applications.filter(app =>
  app.totalOpen > avgOpenItems * 1.5
);

insights.push({
  icon: '📊',
  text: `${highVolumeApps.length} applications have high volume (>${Math.ceil(avgOpenItems * 1.5)} open items each)`,
  recommendation: 'Consider dedicated task force',
  apps: highVolumeApps.slice(0, 5).map(a => a.name)
});
```

3. **Data Quality Issues**
```javascript
// Apps with high scores but no open items (suspicious)
const suspiciousApps = applications.filter(app =>
  app.aggregatedRiskScore > 70 && app.totalOpen === 0
);

if (suspiciousApps.length > 0) {
  insights.push({
    icon: '⚠️',
    text: `${suspiciousApps.length} applications have NO open items despite risk scores >70`,
    recommendation: 'Possible data quality issue - verify these apps',
    priority: 'medium'
  });
}
```

4. **Status Bottlenecks**
```javascript
// Identify if review queue is the bottleneck
const pendingPercentage = (pendingReviewCount / totalOpen * 100).toFixed(0);

if (pendingPercentage > 40) {
  insights.push({
    icon: '🔥',
    text: `${pendingPercentage}% of all risks stuck in PENDING REVIEW status`,
    recommendation: 'Review queue is the bottleneck - need triage sprint',
    priority: 'high'
  });
}
```

5. **Unassigned Risks**
```javascript
// Count unassigned risks and applications
const unassignedRisks = applications
  .flatMap(app => app.risks)
  .filter(risk => !risk.assignedTo);

const appsWithUnassigned = applications.filter(app =>
  app.risks.some(r => !r.assignedTo)
);

if (unassignedRisks.length > 0) {
  insights.push({
    icon: '👤',
    text: `${appsWithUnassigned.length} applications have unassigned risks (${unassignedRisks.length} total risks)`,
    recommendation: 'Assign ownership to improve accountability',
    priority: 'medium'
  });
}
```

**Display Format**:
```
• 🎯 3 applications (Customer Portal, Payment Gateway, Auth Service)
  account for 45% of all critical risks
  → Concentration risk - focus effort here

• 📊 5 applications have high volume (>12 open items each)
  Top: Auth Service (15), Payment Gateway (12)...
  → Consider dedicated task force

• ⚠️ 8 applications have NO open items despite risk scores >70
  → Possible data quality issue - verify these apps
```

---

##### 🛡️ Domain-Specific Insights

**Purpose**: Provide ARB-specific context based on current user's domain and the actual policy registry fields

**Implementation Note**: These insights are generated by analyzing risk `fieldKey` values that match entries in `profile-fields.registry.yaml`. Group risks by their source policy field to surface systemic patterns.

**Security ARB Example**:
```javascript
const securityInsights = [
  {
    pattern: 'waf_protection_missing',
    fieldKey: 'waf_protection',
    query: risks.filter(r =>
      r.fieldKey === 'waf_protection' &&
      r.arbDomain === 'security' &&
      r.status !== 'RESOLVED'
    ),
    template: (apps) =>
      `${apps.length} applications missing WAF protection evidence`,
    recommendation: 'Critical for A1/A2/B rated apps - escalate to security teams',
    apps: ['Customer Portal', 'Auth Service', 'API Gateway']
  },
  {
    pattern: 'encryption_gaps',
    fieldKeys: ['encryption_at_rest', 'encryption_in_transit'],
    query: risks.filter(r =>
      ['encryption_at_rest', 'encryption_in_transit'].includes(r.fieldKey) &&
      r.arbDomain === 'security'
    ),
    template: (count) =>
      `${count} encryption compliance gaps across applications`,
    recommendation: 'Review encryption implementation and evidence'
  },
  {
    pattern: 'stale_security_testing',
    fieldKey: 'security_testing',
    query: risks.filter(r =>
      r.fieldKey === 'security_testing' &&
      r.riskType === 'STALE_EVIDENCE'
    ),
    template: (apps) =>
      `${apps.length} applications with overdue security testing`,
    recommendation: 'Pentest/scan evidence expired - schedule testing'
  },
  {
    pattern: 'mfa_not_enforced',
    fieldKey: 'mfa_enforcement',
    query: risks.filter(r =>
      r.fieldKey === 'mfa_enforcement' &&
      r.priority === 'CRITICAL'
    ),
    template: (apps) =>
      `${apps.length} critical applications without MFA enforcement`,
    recommendation: 'A1/A2 rated apps require MFA - immediate action needed'
  },
  {
    pattern: 'missing_sbom',
    fieldKey: 'dependency_management',
    query: risks.filter(r =>
      r.fieldKey === 'dependency_management'
    ),
    template: (apps) =>
      `${apps.length} applications missing SBOM/dependency tracking`,
    recommendation: 'Implement automated SBOM generation'
  }
];
```

**Data ARB Example**:
```javascript
const dataInsights = [
  {
    pattern: 'confidentiality_violations',
    fieldKey: 'confidentiality_level',
    query: risks.filter(r =>
      r.fieldKey === 'confidentiality_level' &&
      r.arbDomain === 'data'
    ),
    template: (apps) =>
      `${apps.length} applications with confidentiality classification gaps`
  },
  {
    pattern: 'data_residency_violations',
    fieldKey: 'data_residency_control',
    query: risks.filter(r =>
      r.fieldKey === 'data_residency_control' &&
      r.priority === 'CRITICAL'
    ),
    template: (apps) =>
      `${apps.length} applications violating data residency requirements`,
    recommendation: 'A-rated apps require in-region data storage'
  },
  {
    pattern: 'overdue_access_reviews',
    fieldKey: 'access_review',
    query: risks.filter(r =>
      r.fieldKey === 'access_review' &&
      r.riskType === 'STALE_EVIDENCE'
    ),
    template: (apps) =>
      `${apps.length} applications with overdue access reviews`,
    recommendation: 'A-rated apps need quarterly reviews - schedule immediately'
  },
  {
    pattern: 'audit_logging_gaps',
    fieldKey: 'audit_logging',
    query: risks.filter(r =>
      r.fieldKey === 'audit_logging'
    ),
    template: (apps) =>
      `${apps.length} applications with audit logging gaps`,
    recommendation: 'Verify logging implementation and review cadence'
  },
  {
    pattern: 'missing_retention_policy',
    fieldKey: 'data_retention_policy',
    query: risks.filter(r =>
      r.fieldKey === 'data_retention_policy' &&
      r.riskType === 'MISSING_EVIDENCE'
    ),
    template: (apps) =>
      `${apps.length} applications missing data retention policies`,
    recommendation: 'Define and enforce retention policies for A/B rated apps'
  }
];
```

**Operations ARB Example**:
```javascript
const opsInsights = [
  {
    pattern: 'rto_violations',
    fieldKey: 'rto_hours',
    query: risks.filter(r =>
      r.fieldKey === 'rto_hours' &&
      r.priority === 'CRITICAL'
    ),
    template: (apps) =>
      `${apps.length} applications not meeting RTO targets`,
    recommendation: 'A-rated apps require ≤1 hour RTO - review architecture'
  },
  {
    pattern: 'overdue_dr_tests',
    fieldKey: 'dr_test_frequency',
    query: risks.filter(r =>
      r.fieldKey === 'dr_test_frequency' &&
      r.riskType === 'STALE_EVIDENCE'
    ),
    template: (apps) =>
      `${apps.length} applications with overdue DR tests`,
    recommendation: 'Critical apps need semi-annual live DR tests'
  },
  {
    pattern: 'missing_ir_plans',
    fieldKeys: ['ir_plan', 'ir_exercise'],
    query: risks.filter(r =>
      ['ir_plan', 'ir_exercise'].includes(r.fieldKey) &&
      r.riskType === 'MISSING_EVIDENCE'
    ),
    template: (apps) =>
      `${apps.length} applications missing incident response plans`,
    recommendation: 'Document and test IR procedures'
  },
  {
    pattern: 'backup_policy_gaps',
    fieldKey: 'backup_policy',
    query: risks.filter(r =>
      r.fieldKey === 'backup_policy'
    ),
    template: (apps) =>
      `${apps.length} applications with backup policy violations`,
    recommendation: 'Critical apps require encrypted geo-redundant backups'
  },
  {
    pattern: 'monitoring_slo_gaps',
    fieldKey: 'monitoring_slos',
    query: risks.filter(r =>
      r.fieldKey === 'monitoring_slos' &&
      r.priority === 'CRITICAL'
    ),
    template: (apps) =>
      `${apps.length} applications below monitoring SLO targets`,
    recommendation: 'A-rated apps require ≥99.9% with alerting'
  }
];
```

**Enterprise Architecture ARB Example**:
```javascript
const eaInsights = [
  {
    pattern: 'missing_vision_docs',
    fieldKeys: ['product_vision', 'architecture_vision', 'service_vision'],
    query: risks.filter(r =>
      ['product_vision', 'architecture_vision', 'service_vision'].includes(r.fieldKey) &&
      r.riskType === 'MISSING_EVIDENCE'
    ),
    template: (apps, breakdown) =>
      `${apps.length} applications missing governance artifacts: ${breakdown.product_vision} product, ${breakdown.architecture_vision} architecture, ${breakdown.service_vision} service`,
    recommendation: 'Mandatory for A/B rated apps - schedule documentation sessions'
  },
  {
    pattern: 'stale_roadmaps',
    fieldKey: 'product_roadmap',
    query: risks.filter(r =>
      r.fieldKey === 'product_roadmap' &&
      r.riskType === 'STALE_EVIDENCE'
    ),
    template: (apps) =>
      `${apps.length} applications with stale product roadmaps`,
    recommendation: 'Roadmaps require 90-day updates for A/B rated apps'
  }
];
```

**Display Format**:
```
🛡️ SECURITY ARB INSIGHTS (Based on Policy Registry)

• 3 applications missing WAF protection evidence
  (Customer Portal, Auth Service, API Gateway)
  → Critical for A1/A2/B rated apps - escalate to security teams
  Policy: waf_protection (ttl: 90d)

• 8 encryption compliance gaps across applications
  → Review encryption implementation and evidence
  Policies: encryption_at_rest, encryption_in_transit

• 5 critical applications without MFA enforcement
  → A1/A2 rated apps require MFA - immediate action needed
  Policy: mfa_enforcement

• 12 applications missing SBOM/dependency tracking
  → Implement automated SBOM generation
  Policy: dependency_management
```

**Handling Manually Created Risks in Insights**:

When generating domain-specific insights, distinguish between auto-generated and manually created risks:

```javascript
// Example: Count all WAF-related risks (both auto + manual)
const wafRelatedRisks = risks.filter(r =>
  r.arbDomain === 'security' &&
  (
    r.fieldKey === 'waf_protection' || // Auto-generated
    (r.title && r.title.toLowerCase().includes('waf')) // Manually created
  )
);

// Example insight display
if (autoGeneratedWafRisks.length > 0) {
  insights.push({
    text: `${autoGeneratedWafRisks.length} applications missing WAF protection evidence`,
    recommendation: 'Policy: waf_protection (ttl: 90d)'
  });
}

if (manualWafRisks.length > 0) {
  insights.push({
    text: `${manualWafRisks.length} additional WAF concerns raised during reviews`,
    recommendation: 'Review expert findings for context'
  });
}
```

**Filtering Options**:
Add filter to watchlist to distinguish risk sources:
- "All Risks" (default)
- "Policy-Driven Only" (`isAutoGenerated: true`)
- "Expert Findings Only" (`isAutoGenerated: false`)

---

### 5. Application Profile Page (Drill-Down)

#### Purpose
Complete risk profile for a single application with all actionable details.

#### Layout

```
┌────────────────────────────────────────────────────────────┐
│ ← Back to Dashboard                                        │
├────────────────────────────────────────────────────────────┤
│ CUSTOMER PORTAL                                  [Edit ▼]  │
│ Retail Banking | Owner: Jane Smith | BU: Retail           │
│                                                             │
│ ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌──────────┐│
│ │ Risk Score │ │   8 OPEN   │ │ 3 CRITICAL │ │  Last    ││
│ │   F 87/100 │ │   RISKS    │ │   RISKS    │ │  Activity││
│ │   🔴 URGENT│ │            │ │            │ │  2hrs ago││
│ └────────────┘ └────────────┘ └────────────┘ └──────────┘│
│                                                             │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                                                             │
│ [ALL RISKS] [SECURITY ●] [DATA] [OPERATIONS]               │
│                                                             │
│ Filter: [All Statuses ▼] [All Priorities ▼] [Source ▼]    │
│ Sort: [Priority ▼] [Created Date] [Status]                │
│                                             [+ Create Risk] │
│                                                             │
│ ┌──────────────────────────────────────────────────────┐  │
│ │ 🔴 CRITICAL | PENDING REVIEW | Security ARB          │  │
│ │                                                       │  │
│ │ Missing Security Evidence: WAF Configuration         │  │
│ │ SEC-2845 | Created 5 days ago | Assigned: You        │  │
│ │                                                       │  │
│ │ Application has not provided evidence of Web...      │  │
│ │                                                       │  │
│ │ [📎 Evidence] [✏️ Status] [💬 Comment] [👤 Assign]   │  │
│ │                                                       │  │
│ └──────────────────────────────────────────────────────┘  │
│                                                             │
│ ... (more risks)                                            │
│                                                             │
└────────────────────────────────────────────────────────────┘
```

#### Key Features

**Domain Tabs**:
- Filter risks by ARB domain
- Show badge count per domain
- "ALL RISKS" shows cross-domain view

**Risk Cards**:
- Expandable for full details
- Inline action buttons
- Status/priority badges
- **Source indicator**:
  - 🤖 Badge for auto-generated risks (with tooltip showing policy field)
  - 👤 Badge for manually created risks (with tooltip showing creator name)

**Bulk Actions** (when implemented):
- Select multiple risks
- Update status in batch
- Reassign in batch

---

## Interaction Model

### Click Flow Diagram

```
Landing (MY QUEUE Tab)
    ↓
HUD Metric Click → Watchlist Filtered
    ↓
Application Row Click → Application Profile Page
    ↓
Risk Card Click/Expand → Risk Details
    ↓
Action Button Click → Status Updated / Assigned / Commented
    ↓
Navigate Back → Updated Data Reflected
```

### State Management

**Global State**:
- Current scope (MY_QUEUE | MY_DOMAIN | ALL_DOMAINS)
- Current user context (ID, ARB domain, role)
- HUD metrics (cached per scope)

**Watchlist State**:
- Filter state (status, priority, BU, search query)
- Sort state (column, direction)
- Pagination state (current page, items per page)
- Selected applications (for bulk actions)

**Navigation State**:
- Preserve filter/sort when drilling down
- "Back" button returns to previous state
- Deep linking support: `/arb-dashboard?scope=my-queue&sort=risk-score&filter=critical`

---

## Data Requirements

### API Endpoints

#### 1. GET `/api/arb-dashboard`

**Purpose**: Fetch dashboard data based on scope

**Query Parameters**:
- `scope`: `my-queue` | `my-domain` | `all-domains`
- `userId`: Current user ID (for MY_QUEUE filtering)
- `arbDomain`: User's ARB domain (for MY_DOMAIN filtering)

**Response Schema**:
```typescript
interface ArbDashboardResponse {
  applications: Application[];
  metrics: {
    criticalCount: number;
    openItemsCount: number;
    pendingReviewCount: number;
    averageRiskScore: number;
    healthGrade: 'A' | 'B' | 'C' | 'D' | 'F';
    recentActivity: {
      newRisksLast7Days: number;
      resolvedLast7Days: number;
      newRisksLast30Days: number;
      resolvedLast30Days: number;
    };
  };
  insights: Insight[];
}

interface Application {
  id: string;
  name: string;
  businessUnit: string;
  owner: string;
  ownerId: string;
  aggregatedRiskScore: number; // 0-100
  totalOpenItems: number;
  riskBreakdown: {
    critical: number;
    high: number;
    medium: number;
    low: number;
  };
  domains: string[]; // ['security', 'data', ...]
  hasAssignedRisks: boolean; // for current user
  lastActivityDate: string; // ISO 8601
  risks: Risk[];
}

interface Risk {
  id: string;
  title: string;
  description: string;
  priority: 'CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW';
  status: 'NEW' | 'PENDING_REVIEW' | 'OPEN' | 'IN_PROGRESS' | 'RESOLVED' | 'ACCEPTED';
  arbDomain: string; // 'security' | 'data' | 'operations' | 'enterprise_architecture'

  // Source of risk creation
  isAutoGenerated: boolean; // true = policy engine, false = manually created

  // Policy-driven fields (ONLY for auto-generated risks from profile-fields.registry.yaml)
  fieldKey?: string; // e.g., 'waf_protection', 'encryption_at_rest', 'rto_hours'
                     // null for manually created risks
  riskType?: 'MISSING_EVIDENCE' | 'STALE_EVIDENCE' | 'POLICY_VIOLATION';
             // null for manually created risks
  ttlDays?: number; // From registry rule, null for manually created risks
  daysOverdue?: number; // For STALE_EVIDENCE, how many days past TTL

  // Assignment & ownership
  assignedTo: string | null;
  assignedToName: string | null;
  createdBy?: string; // User ID who manually created the risk (if isAutoGenerated = false)
  createdByName?: string;

  // Timestamps
  createdDate: string; // ISO 8601
  updatedDate: string; // ISO 8601
  dueDate: string | null; // ISO 8601

  // Additional metadata
  category?: string; // Free-form category for manually created risks
  tags: string[];
  comments?: Comment[]; // Discussion thread
}

interface Insight {
  id: string;
  type: 'concentration' | 'volume' | 'bottleneck' | 'data_quality' | 'domain_specific';
  icon: string;
  text: string;
  recommendation: string;
  priority: 'high' | 'medium' | 'low';
  relatedApps?: string[];
}
```

#### 2. GET `/api/applications/:id`

**Purpose**: Fetch detailed application profile with all risks

**Response Schema**:
```typescript
interface ApplicationDetail extends Application {
  metadata: {
    description: string;
    technicalStack: string[];
    criticalityLevel: 'HIGH' | 'MEDIUM' | 'LOW';
    dataClassification: string;
  };
  riskHistory: RiskHistoryEntry[];
}

interface RiskHistoryEntry {
  riskId: string;
  event: 'CREATED' | 'UPDATED' | 'RESOLVED' | 'REASSIGNED';
  timestamp: string;
  user: string;
  details: string;
}
```

#### 3. PATCH `/api/risks/:id`

**Purpose**: Update risk status, assignment, or other fields

**Request Body**:
```typescript
interface RiskUpdateRequest {
  status?: Risk['status'];
  assignedTo?: string;
  comment?: string;
  priority?: Risk['priority'];
}
```

#### 4. POST `/api/risks/:id/comments`

**Purpose**: Add comment to risk

**Request Body**:
```typescript
interface CommentRequest {
  text: string;
  mentions?: string[]; // User IDs to notify
}
```

#### 5. POST `/api/applications/:id/risks`

**Purpose**: Manually create a new risk for an application (ARB expert action)

**Request Body**:
```typescript
interface CreateRiskRequest {
  title: string;                  // Required
  description: string;            // Required
  priority: 'CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW';
  arbDomain: string;              // 'security' | 'data' | 'operations' | 'enterprise_architecture'
  assignedTo?: string;            // Optional: User ID
  dueDate?: string;               // Optional: ISO 8601
  category?: string;              // Optional: Free-form category
  tags?: string[];                // Optional
}
```

**Response**:
```typescript
interface CreateRiskResponse {
  risk: Risk; // Newly created risk with isAutoGenerated: false
}
```

**Validation**:
- Title: 1-200 characters
- Description: 1-2000 characters
- arbDomain must be valid domain
- createdBy automatically set to current user
- isAutoGenerated automatically set to false
- fieldKey, riskType, ttlDays remain null (not applicable)

### Data Calculations

#### Aggregated Risk Score

```typescript
function calculateAggregatedRiskScore(risks: Risk[]): number {
  const weights = {
    CRITICAL: 100,
    HIGH: 75,
    MEDIUM: 50,
    LOW: 25
  };

  const statusMultipliers = {
    NEW: 1.0,
    PENDING_REVIEW: 1.0,
    OPEN: 1.0,
    IN_PROGRESS: 0.5, // Being worked on, lower urgency
    RESOLVED: 0, // Don't count
    ACCEPTED: 0.3 // Accepted risk, lower urgency
  };

  const openRisks = risks.filter(r => r.status !== 'RESOLVED');

  if (openRisks.length === 0) return 0;

  const totalScore = openRisks.reduce((sum, risk) => {
    const baseScore = weights[risk.priority] || 0;
    const multiplier = statusMultipliers[risk.status] || 1;
    return sum + (baseScore * multiplier);
  }, 0);

  // Normalize to 0-100 scale
  const maxPossibleScore = openRisks.length * 100;
  return Math.min((totalScore / maxPossibleScore) * 100, 100);
}
```

---

## Implementation Roadmap

### Phase 1: MVP - Core Application-Centric View (2-3 weeks)

**Goals**:
- Implement basic application-centric navigation
- Enable primary triage workflows

**Features**:
- Scoping tabs (My Queue, My Domain, All Domains)
- HUD with 5 core metrics
- Application watchlist with sortable table
- Application profile page
- Basic filtering (status, priority)

**Success Criteria**:
- Users can land on personalized My Queue
- Users can click through from HUD → Watchlist → App Detail
- Users can sort by risk score, open items, critical count

**Technical Tasks**:
1. Create `ScopingTabs` component
2. Create `HeadsUpDisplay` component with clickable metrics
3. Create `ApplicationWatchlist` component with sortable table
4. Implement `ApplicationRow` component with all data fields
5. Create `ApplicationProfilePage` component
6. Implement API endpoint `/api/arb-dashboard` with scope filtering
7. Add `status` field to risk model with PENDING_REVIEW option
8. Update aggregated risk score calculation

---

### Phase 2: Strategic Insights & Analytics (1-2 weeks)

**Goals**:
- Add analytical depth
- Surface patterns and recommendations

**Features**:
- Key Insights section (collapsible)
- Resolution Performance analytics
- Domain-specific insights
- Net Change metric with resolution rate

**Success Criteria**:
- Users see actionable insights based on current data
- Users understand if they're keeping up with new risks
- Domain experts see relevant patterns for their ARB

**Technical Tasks**:
1. Create `InsightsSection` component
2. Implement cross-metric intelligence algorithms
3. Create domain-specific insight templates
4. Add resolution performance calculations
5. Implement `recentActivity` tracking in backend
6. Create insight generation service

---

### Phase 3: Advanced Interactions & Polish (1-2 weeks)

**Goals**:
- Enhance user experience
- Add power-user features

**Features**:
- Search functionality
- Advanced filtering (business unit, owner)
- Bulk actions (select multiple apps/risks)
- Saved filters
- Export to CSV
- Notifications integration
- Mobile responsive layout

**Success Criteria**:
- Users can quickly find specific applications
- Power users can create custom views
- Mobile users have functional experience

**Technical Tasks**:
1. Implement search with debouncing
2. Add business unit and owner filters
3. Create bulk action system
4. Implement saved filter persistence
5. Add CSV export functionality
6. Integrate with notification system
7. Implement responsive breakpoints
8. Add keyboard navigation

---

### Phase 4: Performance & Optimization (1 week)

**Goals**:
- Ensure scalability
- Optimize for large datasets

**Features**:
- Virtual scrolling for large lists
- Lazy loading
- Caching strategy
- Performance monitoring

**Success Criteria**:
- Dashboard loads in < 2 seconds
- Watchlist handles 500+ applications smoothly
- No UI blocking on filter/sort

**Technical Tasks**:
1. Implement virtual scrolling for watchlist
2. Add request caching with invalidation
3. Optimize aggregated score calculation
4. Add performance monitoring
5. Implement progressive loading
6. Optimize bundle size

---

## Success Metrics

### User Engagement Metrics

1. **Time to First Action**
   - Measure: Time from page load to first meaningful interaction
   - Target: < 5 seconds
   - Tracks: How quickly users can identify and act on priorities

2. **Click-Through Rate**
   - Measure: % of users who click through to application details
   - Target: > 60%
   - Tracks: Whether dashboard surfaces relevant information

3. **Actions Per Session**
   - Measure: Average number of risk updates/assignments per visit
   - Target: > 3 actions
   - Tracks: Productivity enabled by the interface

4. **Return Visit Rate**
   - Measure: % of users who return within 24 hours
   - Target: > 70%
   - Tracks: Whether dashboard becomes daily workflow tool

### Task Completion Metrics

5. **Triage Time Reduction**
   - Measure: Time to review and assign pending risks
   - Target: 50% reduction vs. old dashboard
   - Tracks: Efficiency improvement

6. **Risk Resolution Rate**
   - Measure: # of risks resolved per week
   - Target: 15% increase
   - Tracks: Whether actionability drives outcomes

7. **Backlog Growth Rate**
   - Measure: Net change in open items over time
   - Target: Negative (shrinking backlog)
   - Tracks: Overall effectiveness

### User Satisfaction Metrics

8. **Feature Adoption Rate**
   - Measure: % of users who use each major feature
   - Target:
     - My Queue tab: > 80%
     - HUD metrics: > 60%
     - Sorting/filtering: > 50%
     - Insights section: > 30%

9. **User Satisfaction Score**
   - Measure: Survey rating (1-5)
   - Target: > 4.0
   - Tracks: Overall user happiness

10. **Feature Request Rate**
    - Measure: # of enhancement requests per month
    - Target: Stable or decreasing
    - Tracks: Whether design meets user needs

---

## Appendix

### A. Color Palette

**Priority Colors**:
- Critical: `#D32F2F` (Red 700)
- High: `#F57C00` (Orange 700)
- Medium: `#FBC02D` (Yellow 700)
- Low: `#616161` (Grey 700)

**Status Colors**:
- New/Pending: `#D32F2F` (Red)
- Open: `#F57C00` (Orange)
- In Progress: `#1976D2` (Blue)
- Resolved: `#388E3C` (Green)
- Accepted: `#455A64` (Blue Grey)

**Health Grades**:
- A: `#4CAF50` (Green 500)
- B: `#8BC34A` (Light Green 500)
- C: `#FFC107` (Amber 500)
- D: `#FF9800` (Orange 500)
- F: `#F44336` (Red 500)

### B. Typography

**Font Family**:
- Primary: `'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif`
- Monospace: `'SF Mono', 'Monaco', 'Consolas', monospace` (for IDs, codes)

**Font Sizes**:
- H1: 32px (Page title)
- H2: 24px (Section headers)
- H3: 18px (Subsection headers)
- Body: 14px (Default text)
- Caption: 12px (Labels, metadata)

**Font Weights**:
- Regular: 400
- Medium: 500
- Semibold: 600
- Bold: 700

### C. Accessibility Considerations

1. **Color Contrast**: All text meets WCAG AA standards (4.5:1 ratio)
2. **Keyboard Navigation**: Full keyboard support for all interactive elements
3. **Screen Readers**: Proper ARIA labels and semantic HTML
4. **Focus Indicators**: Clear focus states for keyboard users
5. **Alternative Text**: Icons supplemented with text labels
6. **Color Independence**: Information not conveyed by color alone

### D. Browser Support

**Target Browsers**:
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

**Mobile Support**:
- iOS Safari 14+
- Chrome Mobile 90+

### E. Testing Checklist

**Unit Tests**:
- [ ] Risk score calculation
- [ ] Resolution rate calculation
- [ ] Insight generation logic
- [ ] Filter/sort functions

**Integration Tests**:
- [ ] API endpoint responses
- [ ] State management
- [ ] Navigation flows

**E2E Tests**:
- [ ] My Queue → Application → Risk → Action flow
- [ ] HUD metric click → Filter application
- [ ] Sorting and filtering
- [ ] Search functionality

**Performance Tests**:
- [ ] Load time with 500 applications
- [ ] Sort/filter responsiveness
- [ ] Memory usage

**Accessibility Tests**:
- [ ] Keyboard navigation
- [ ] Screen reader compatibility
- [ ] Color contrast validation

---

## Document History

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 2025-10-13 | Design Team | Initial specification |
| 1.1 | 2025-10-13 | Design Team | Updated to reflect policy-driven risk generation based on `profile-fields.registry.yaml`. Clarified that risks are auto-generated, not manually created. Updated User Personas with actual registry field workflows and Domain-Specific Insights with real policy fields. |
| 1.2 | 2025-10-13 | Design Team | Correction: Clarified that ARB experts CAN manually create risks during reviews (10-20% of risks). Updated Risk data model with `isAutoGenerated` field and optional policy fields. Added "Source" filter, risk creation UI, and POST endpoint for manual risk creation. |

---

## Feedback & Questions

For questions or feedback on this specification, contact:
- Product Owner: [Name]
- Design Lead: [Name]
- Engineering Lead: [Name]

---

**End of Document**
